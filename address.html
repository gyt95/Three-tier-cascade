<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>三层级联选择</title>
    <link rel="stylesheet" href="./address.css">
</head>
<body>
    <!-- <div class="ekt-container"></div> -->
    <div>
        <li class="input-start">
            <span class="name">起点科室:</span>
            <input type="text" class="input-start" readonly>
        </li>
        <li class="input-destination">
            <span class="name">目的地:</span>
            <input type="text" class="input-destination" readonly>
        </li>
    </div>

    <div class="ekt-container ekt-container-start"></div>
    <div class="ekt-container ekt-container-destination"></div>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
    <script src="./db.js"></script>
    <script src="./address.js"></script>
    <script>
        // 用$.getJSON('./db.json', function(res){...}) 
        // Chrome 浏览器会报错，禁止请求本地数据

        // $('.ekt-container').picker({
        //     data: res.data, // 传入的三层级联数据
        //     multiple: true, // 是否多选
        //     size: 'mini',   // 尺寸
        //     // position: 'top',  // 定位位置，默认为default，可选：top/default
        //     speed: 0,     // 动画速度，默认为0
        //     backgroundColor: '#f2f2f2', // 选项背景色
        //     callback: function(data){
        //         console.log('返回地址全称成功!')
        //         console.log(data)
        //     }
        // })
        console.log(res)

        $('body').on('click', '.input-destination', setDestination)
        $('body').on('click', '.input-start', clickToSetDefaultRoom)

        function clickToSetDefaultRoom(){
            if(!$('.ekt-container-destination').is(':hidden')){
                $('.ekt-container-destination').hide()
            }
            $('.ekt-container-start').show()

            $('.ekt-container-start').picker({
                data: res.data, // 传入的三层级联数据
                multiple: false, // 是否多选
                size: 'mini',   // 尺寸
                // position: 'top',  // 定位位置，默认为default，可选：top/default
                speed: 0,     // 动画速度，默认为0
                backgroundColor: '#f2f2f2', // 选项背景色
                callback: function(data){
                    console.log('返回地址全称成功!')
                    console.log(data)

                    var fullAddress = '';
                    for(var i=0; i< data.length; i++){
                        fullAddress = fullAddress + data[i] + ' '
                    }
                    $('.input-start').val(fullAddress)
                }
            })
        }
        
        function setDestination(){
            if(!$('.ekt-container-start').is(':hidden')){
                $('.ekt-container-start').hide()
            }
            $('.ekt-container-destination').show()

            $('.ekt-container-destination').picker({
                data: res.data, // 传入的三层级联数据
                multiple: true, // 是否多选
                size: 'mini',   // 尺寸
                // position: 'top',  // 定位位置，默认为default，可选：top/default
                speed: 500,     // 动画速度，默认为0
                backgroundColor: '#f2f2f2', // 选项背景色
                number: 1,
                callback: function(data){
                    console.log('返回地址全称成功!')
                    console.log(data)

                    var fullAddress = '';
                    for(var i=0; i< data.length; i++){
                        fullAddress = fullAddress + data[i] + ' '
                    }
                    $('.input-destination').val(fullAddress)
                }
            })
        }
    </script>
</body>
</html>